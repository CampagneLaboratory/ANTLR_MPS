package org.campagnelab.antlr.tomps.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.smodel.Language;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.smodel.LanguageAspect;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.internal.collections.runtime.IWhereFilter;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.mps.openapi.language.SConceptRepository;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.internal.collections.runtime.IVisitor;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import jetbrains.mps.smodel.behaviour.BehaviorReflection;
import jetbrains.mps.internal.collections.runtime.ISelector;
import jetbrains.mps.baseLanguage.closures.runtime.Wrappers;
import jetbrains.mps.baseLanguage.tuples.runtime.MultiTuple;
import org.apache.log4j.Logger;
import org.apache.log4j.LogManager;
import org.jetbrains.mps.openapi.persistence.PersistenceFacade;
import jetbrains.mps.smodel.SModelUtil_new;
import org.jetbrains.mps.openapi.model.SNodeAccessUtil;

public class ConceptMapper_Behavior {
  public static void init(SNode thisNode) {
  }
  public static Language call_language_7627187573640578145(SNode thisNode) {
    return ConvertToMPS_Behavior.call_getLanguage_7627187573640238110(SNodeOperations.getNodeAncestor(thisNode, MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea6061b82L, "org.campagnelab.antlr.tomps.structure.ConvertToMPS"), false, false));
  }
  public static SNode call_converter_558881339892985529(SNode thisNode) {
    return SNodeOperations.getNodeAncestor(thisNode, MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea6061b82L, "org.campagnelab.antlr.tomps.structure.ConvertToMPS"), false, false);
  }
  public static SNode call_visitorReturnConcept_558881339892987079(SNode thisNode) {
    return SLinkOperations.getTarget(thisNode, MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x69d936b00a0eba02L, 0x69d936b00a0eba03L, "concept"));
  }
  public static SNode call_grammar_558881339893016520(SNode thisNode) {
    return SLinkOperations.getTarget(SNodeOperations.getNodeAncestor(thisNode, MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea6061b82L, "org.campagnelab.antlr.tomps.structure.ConvertToMPS"), false, false), MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea6061b82L, 0x6a1bb02ea6061be9L, "grammar"));
  }
  public static SNode call_looupOrCreate_1826877622988453211(SAbstractConcept thisConcept, Language language, String name) {
    final String upperCasedName = "" + Character.toUpperCase(name.charAt(0)) + name.subSequence(1, name.length());
    SModel structureModel = LanguageAspect.STRUCTURE.get(language);
    SNode first = ListSequence.fromList(SModelOperations.roots(structureModel, MetaAdapterFactory.getConcept(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, "jetbrains.mps.lang.structure.structure.ConceptDeclaration"))).findFirst(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return eq_z4rl0_a0a0a0a0a0a2a5(SPropertyOperations.getString(it, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")), upperCasedName);
      }
    });
    if (first != null) {
      return first;
    } else {
      return ConceptMapper_Behavior.call_createConcept_558881339898873634(SConceptRepository.getInstance().getConcept("org.campagnelab.antlr.tomps.structure.ConceptMapper"), language, name);
    }
  }
  public static SNode call_looupOrCreate_1826877622988760384(SNode thisNode, String name) {
    return ConceptMapper_Behavior.call_looupOrCreate_1826877622988453211(SNodeOperations.asSConcept(MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x69d936b00a0eba02L, "org.campagnelab.antlr.tomps.structure.ConceptMapper")), ConceptMapper_Behavior.call_language_7627187573640578145(thisNode), name);
  }
  public static SNode call_createConcept_558881339898873634(SAbstractConcept thisConcept, Language language, String name) {
    final String upperCasedName = "" + Character.toUpperCase(name.charAt(0)) + name.subSequence(1, name.length());
    SModel structureModel = LanguageAspect.STRUCTURE.get(language);
    // create the concept if one with the same name does not already exist: 
    if (ListSequence.fromList(SModelOperations.roots(structureModel, MetaAdapterFactory.getConcept(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, "jetbrains.mps.lang.structure.structure.ConceptDeclaration"))).all(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return neq_z4rl0_a0a0a0a0a0d0h(SPropertyOperations.getString(it, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")), upperCasedName);
      }
    })) {
      SNode decl = SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, "jetbrains.mps.lang.structure.structure.ConceptDeclaration")));
      SModelOperations.addRootNode(structureModel, decl);
      SPropertyOperations.set(decl, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"), upperCasedName);
      return decl;
    } else {
      return null;
    }
  }
  public static Iterable<SNode> call_altMappers_558881339902034843(final SNode thisNode) {
    return ListSequence.fromList(SNodeOperations.getNodeDescendants(ConceptMapper_Behavior.call_converter_558881339892985529(thisNode), MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea606232bL, "org.campagnelab.antlr.tomps.structure.AlternativeMapper"), false, new SAbstractConcept[]{})).where(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return AlternativeMapper_Behavior.call_rule_558881339899314132(it) == SLinkOperations.getTarget(thisNode, MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x69d936b00a0eba02L, 0x69d936b00a0eba05L, "rule"));
      }
    });
  }
  public static boolean call_hasLabels_8933086517772846254(SNode thisNode) {
    return ListSequence.fromList(SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(thisNode, MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x69d936b00a0eba02L, 0x69d936b00a0eba05L, "rule")), MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113b458fL, "org.campagnelab.ANTLR.structure.Alternative"), false, new SAbstractConcept[]{})).where(new IWhereFilter<SNode>() {
      public boolean accept(SNode alt) {
        return SNodeOperations.isInstanceOf(SNodeOperations.getParent(SNodeOperations.getParent(alt)), MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x175f2668a88648aaL, "org.campagnelab.ANTLR.structure.Rule"));
      }
    }).all(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return SPropertyOperations.getBoolean(it, MetaAdapterFactory.getProperty(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113b458fL, 0x6d831d6acf051327L, "hasLabel"));
      }
    });
  }
  public static String call_upperCaseFirstChar_4917522066818939248(SNode thisNode, String value) {
    return "" + Character.toUpperCase(value.charAt(0)) + value.substring(1, value.length()).toString();
  }
  public static void call_createEditorFor_1849555336877531523(SNode thisNode, final SNode concept, SNode alternative, SNode altMapper) {
    if (concept == null) {
      return;
    }
    SModel editorModel = LanguageAspect.EDITOR.get(ConceptMapper_Behavior.call_language_7627187573640578145(thisNode));
    ListSequence.fromList(SModelOperations.roots(editorModel, MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9845363abL, "jetbrains.mps.lang.editor.structure.ConceptEditorDeclaration"))).where(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return SLinkOperations.getTarget(it, MetaAdapterFactory.getReferenceLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0x10f7df344a9L, 0x10f7df451aeL, "conceptDeclaration")) == concept;
      }
    }).visitAll(new IVisitor<SNode>() {
      public void visit(SNode it) {
        SNodeOperations.deleteNode(it);
      }
    });

    SNode editor = SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9845363abL, "jetbrains.mps.lang.editor.structure.ConceptEditorDeclaration")));
    SLinkOperations.setTarget(editor, MetaAdapterFactory.getReferenceLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0x10f7df344a9L, 0x10f7df451aeL, "conceptDeclaration"), concept);
    SLinkOperations.setTarget(editor, MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xfba0eb7c50L, 0xfba0ec5415L, "cellModel"), ConceptMapper_Behavior.call_cellModel_1849555336878701510(thisNode, alternative, altMapper));
    SModelOperations.addRootNode(editorModel, editor);
  }
  public static void call_createEditors_1849555336877441106(final SNode thisNode) {
    Sequence.fromIterable(ConceptMapper_Behavior.call_altMappers_558881339902034843(thisNode)).visitAll(new IVisitor<SNode>() {
      public void visit(SNode altMapper) {

        ConceptMapper_Behavior.call_createEditorFor_1849555336877531523(thisNode, AlternativeMapper_Behavior.call_visitorReturnConcept_558881339892896625(altMapper), SLinkOperations.getTarget(altMapper, MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea606232bL, 0x6a1bb02ea6062391L, "alternative")), altMapper);
      }
    });
  }
  public static SNode call_cellModel_1849555336878701510(SNode thisNode, SNode alternative, SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting Alternative");
    }

    SNode cellModel = _quotation_createNode_z4rl0_a0c0m();
    ListSequence.fromList(SLinkOperations.getChildren(cellModel, MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, 0xf9eaff2518L, "childCellModel"))).addElement(ConceptMapper_Behavior.call_cellModel_1849555336878833409(thisNode, SLinkOperations.getTarget(alternative, MetaAdapterFactory.getContainmentLink(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113b458fL, 0x631eebe3113b4590L, "rhs")), altMapper));
    return cellModel;
  }
  public static SNode call_cellModel_1849555336878833409(SNode thisNode, SNode block, SNode altMapper) {
    {
      final SNode ruleRef = block;
      if (SNodeOperations.isInstanceOf(ruleRef, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe31132d966L, "org.campagnelab.ANTLR.structure.ParserRuleRef"))) {
        return ConceptMapper_Behavior.call_cellModel_1849555336879372042(thisNode, ruleRef, altMapper);
      }
    }
    {
      final SNode ruleRef = block;
      if (SNodeOperations.isInstanceOf(ruleRef, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x175f2668a890ef9eL, "org.campagnelab.ANTLR.structure.LexerRuleRef"))) {
        return ConceptMapper_Behavior.call_cellModel_1849555336887504686(thisNode, ruleRef, altMapper);
      }
    }
    {
      final SNode stringLiteral = block;
      if (SNodeOperations.isInstanceOf(stringLiteral, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113e657fL, "org.campagnelab.ANTLR.structure.StringLiteral"))) {
        return ConceptMapper_Behavior.call_cellModel_1849555336879378070(thisNode, stringLiteral, altMapper);
      }
    }
    {
      final SNode seq = block;
      if (SNodeOperations.isInstanceOf(seq, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe31132d846L, "org.campagnelab.ANTLR.structure.Sequence"))) {
        return ConceptMapper_Behavior.call_cellModel_1849555336880419944(thisNode, seq, altMapper);
      }
    }
    {
      final SNode labeled = block;
      if (SNodeOperations.isInstanceOf(labeled, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x7c18b9e17b73a85L, "org.campagnelab.ANTLR.structure.LabeledElement"))) {
        return ConceptMapper_Behavior.call_cellModel_1849555336886703143(thisNode, labeled, altMapper);
      }
    }
    {
      final SNode labeled = block;
      if (SNodeOperations.isInstanceOf(labeled, MetaAdapterFactory.getConcept(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x4e506a1ba17206d3L, "org.campagnelab.ANTLR.structure.LexerRuleRefByName"))) {
        return _quotation_createNode_z4rl0_a0a5a31();
      }
    }
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting:" + SNodeOperations.getConcept(block).getName());
    }
    return _quotation_createNode_z4rl0_a7a31();
  }
  public static SNode call_cellModel_1849555336879372042(SNode thisNode, SNode ruleRef, SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting ruleRef");
    }
    String ruleRefName = SPropertyOperations.getString(SLinkOperations.getTarget(ruleRef, MetaAdapterFactory.getReferenceLink(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe31132d966L, 0x631eebe31132d967L, "rule")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"));
    String cardinality;
    Tuples._2<SNode, String> destination_cardinality = ConceptMapper_Behavior.call_findDestination_4522383332277190979(SConceptRepository.getInstance().getConcept("org.campagnelab.antlr.tomps.structure.ConceptMapper"), altMapper, ruleRefName);
    SNode cellModel = BehaviorReflection.invokeVirtual((Class<SNode>) ((Class) Object.class), destination_cardinality._0(), "virtual_cellModel_1849555336881449838", new Object[]{destination_cardinality._1()});
    if (cellModel != null) {
      return cellModel;
    }
    return _quotation_createNode_z4rl0_a6a41(ruleRefName);
  }
  public static SNode call_cellModel_1849555336887504686(SNode thisNode, SNode ruleRef, SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting lexerRuleRef");
    }
    String ruleRefName = SPropertyOperations.getString(SLinkOperations.getTarget(ruleRef, MetaAdapterFactory.getReferenceLink(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x175f2668a890ef9eL, 0x175f2668a890ef9fL, "rule")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name"));
    Tuples._2<SNode, String> destination_cardinality = ConceptMapper_Behavior.call_findDestination_4522383332277190979(SConceptRepository.getInstance().getConcept("org.campagnelab.antlr.tomps.structure.ConceptMapper"), altMapper, ruleRefName);
    SNode cellModel = BehaviorReflection.invokeVirtual((Class<SNode>) ((Class) Object.class), destination_cardinality._0(), "virtual_cellModel_1849555336881449838", new Object[]{destination_cardinality._1()});
    if (cellModel != null) {
      return cellModel;
    }
    return _quotation_createNode_z4rl0_a5a51(ruleRefName);
  }
  public static SNode call_cellModel_1849555336879378070(SNode thisNode, SNode literal, SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting literal");
    }

    return _quotation_createNode_z4rl0_a2a61(SPropertyOperations.getString(literal, MetaAdapterFactory.getProperty(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113e657fL, 0x631eebe3113e6580L, "literal")));
  }
  public static SNode call_cellModel_1849555336886703143(SNode thisNode, SNode labeledElement, SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting labeledElement");
    }
    Tuples._2<SNode, String> destination_cardinality = ConceptMapper_Behavior.call_findDestination_4522383332277190979(SConceptRepository.getInstance().getConcept("org.campagnelab.antlr.tomps.structure.ConceptMapper"), altMapper, SPropertyOperations.getString(labeledElement, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")));
    SNode cellModel = BehaviorReflection.invokeVirtual((Class<SNode>) ((Class) Object.class), destination_cardinality._0(), "virtual_cellModel_1849555336881449838", new Object[]{destination_cardinality._1()});
    if (cellModel != null) {
      return cellModel;
    }
    return _quotation_createNode_z4rl0_a4a71(SPropertyOperations.getString(labeledElement, MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")));
  }
  public static SNode call_cellModel_1849555336880419944(final SNode thisNode, SNode sequence, final SNode altMapper) {
    if (LOG.isInfoEnabled()) {
      LOG.info("visiting Sequence");
    }
    SNode cellmodel = SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, "jetbrains.mps.lang.editor.structure.CellModel_Collection")));
    Iterable<SNode> cells = ListSequence.fromList(SLinkOperations.getChildren(sequence, MetaAdapterFactory.getContainmentLink(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe31132d846L, 0x631eebe31132d96bL, "of"))).select(new ISelector<SNode, SNode>() {
      public SNode select(SNode it) {
        return ConceptMapper_Behavior.call_cellModel_1849555336878833409(thisNode, it, altMapper);
      }
    });
    ListSequence.fromList(SLinkOperations.getChildren(cellmodel, MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, 0xf9eaff2518L, "childCellModel"))).addSequence(Sequence.fromIterable(cells));
    return cellmodel;
  }
  public static SNode call_cellModel_1849555336880416531(SNode thisNode, SNode literal) {
    return _quotation_createNode_z4rl0_a0a91(SPropertyOperations.getString(literal, MetaAdapterFactory.getProperty(0xd6782141eafa4cf7L, 0xa85d1229abdb1152L, 0x631eebe3113e657fL, 0x631eebe3113e6580L, "literal")));
  }
  public static void call_createTextGenFor_4522383332274891725(SNode thisNode, final SNode concept, SNode alternative, SNode altMapper) {
    if (concept == null) {
      return;
    }
    SModel textGenModel = LanguageAspect.TEXT_GEN.get(ConceptMapper_Behavior.call_language_7627187573640578145(thisNode));
    ListSequence.fromList(SModelOperations.roots(textGenModel, MetaAdapterFactory.getConcept(0xb83431fe5c8f40bcL, 0x8a3665e25f4dd253L, 0x11f3c776369L, "jetbrains.mps.lang.textGen.structure.ConceptTextGenDeclaration"))).where(new IWhereFilter<SNode>() {
      public boolean accept(SNode it) {
        return SLinkOperations.getTarget(it, MetaAdapterFactory.getReferenceLink(0xb83431fe5c8f40bcL, 0x8a3665e25f4dd253L, 0x11f3c776369L, 0x11f3c7a3d4dL, "conceptDeclaration")) == concept;
      }
    }).visitAll(new IVisitor<SNode>() {
      public void visit(SNode it) {
        SNodeOperations.deleteNode(it);
      }
    });

    SNode textGen = TextGenHelper_Behavior.call_textGenComponent_4522383332274393733(SNodeOperations.asSConcept(MetaAdapterFactory.getConcept(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x3ec2bbae1a5cc460L, "org.campagnelab.antlr.tomps.structure.TextGenHelper")), alternative, altMapper);
    SLinkOperations.setTarget(textGen, MetaAdapterFactory.getReferenceLink(0xb83431fe5c8f40bcL, 0x8a3665e25f4dd253L, 0x11f3c776369L, 0x11f3c7a3d4dL, "conceptDeclaration"), concept);
    SModelOperations.addRootNode(textGenModel, textGen);
  }
  public static void call_createTextGens_4522383332274891802(final SNode thisNode) {
    Sequence.fromIterable(ConceptMapper_Behavior.call_altMappers_558881339902034843(thisNode)).visitAll(new IVisitor<SNode>() {
      public void visit(SNode altMapper) {

        ConceptMapper_Behavior.call_createTextGenFor_4522383332274891725(thisNode, AlternativeMapper_Behavior.call_visitorReturnConcept_558881339892896625(altMapper), SLinkOperations.getTarget(altMapper, MetaAdapterFactory.getReferenceLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea606232bL, 0x6a1bb02ea6062391L, "alternative")), altMapper);
      }
    });
  }
  public static Tuples._2<SNode, String> call_findDestination_4522383332277190979(SAbstractConcept thisConcept, SNode altMapper, final String ruleRefName) {
    final Wrappers._T<String> cardinality = new Wrappers._T<String>();
    return MultiTuple.<SNode,String>from(SLinkOperations.getTarget(ListSequence.fromList(SLinkOperations.getChildren(altMapper, MetaAdapterFactory.getContainmentLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x6a1bb02ea606232bL, 0x7c18b9e1882f807L, "map"))).findFirst(new IWhereFilter<SNode>() {
      public boolean accept(SNode mapper) {
        // <node> 
        cardinality.value = SPropertyOperations.getString_def(SLinkOperations.getTarget(mapper, MetaAdapterFactory.getContainmentLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x7c18b9e1882f81cL, 0x3875e55a78ffcbddL, "source")), MetaAdapterFactory.getProperty(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x3875e55a78eeb7ddL, 0x32ac4b93a6b7ec8L, "cardinality"), "0..1");
        return eq_z4rl0_a0c0a0a0a0a0b0x(BehaviorReflection.invokeVirtual(String.class, SLinkOperations.getTarget(mapper, MetaAdapterFactory.getContainmentLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x7c18b9e1882f81cL, 0x3875e55a78ffcbddL, "source")), "virtual_name_4068410015138152876", new Object[]{}), ruleRefName);
      }
    }), MetaAdapterFactory.getContainmentLink(0x932d719ce93144d5L, 0x990ce115f79b5942L, 0x7c18b9e1882f81cL, 0x4aaf5f3861bb9078L, "destination")), cardinality.value);
  }
  protected static Logger LOG = LogManager.getLogger(ConceptMapper_Behavior.class);
  private static SNode _quotation_createNode_z4rl0_a0c0m() {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_1 = null;
    SNode quotedNode_2 = null;
    quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, "jetbrains.mps.lang.editor.structure.CellModel_Collection"), null, null, false);
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0x120150bb441L, "jetbrains.mps.lang.editor.structure.CellLayout_Indent"), null, null, false);
    quotedNode_1.addChild(MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, 0x10192e0d3baL, "cellLayout"), quotedNode_2);
    return quotedNode_1;
  }
  private static SNode _quotation_createNode_z4rl0_a0a5a31() {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_1 = null;
    quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0x73604585b6d5c973L, "jetbrains.mps.lang.editor.structure.CellModel_Empty"), null, null, false);
    return quotedNode_1;
  }
  private static SNode _quotation_createNode_z4rl0_a7a31() {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_1 = null;
    SNode quotedNode_2 = null;
    quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, "jetbrains.mps.lang.editor.structure.CellModel_Collection"), null, null, false);
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), "ParserRuleBlock");
    quotedNode_1.addChild(MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eaff2517L, 0xf9eaff2518L, "childCellModel"), quotedNode_2);
    return quotedNode_1;
  }
  private static SNode _quotation_createNode_z4rl0_a6a41(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_z4rl0_a5a51(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_z4rl0_a2a61(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_z4rl0_a4a71(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), (String) parameter_1);
    return quotedNode_2;
  }
  private static SNode _quotation_createNode_z4rl0_a0a91(Object parameter_1) {
    PersistenceFacade facade = PersistenceFacade.getInstance();
    SNode quotedNode_2 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration(MetaAdapterFactory.getConcept(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, "jetbrains.mps.lang.editor.structure.CellModel_Constant"), null, null, false);
    SNodeAccessUtil.setProperty(quotedNode_2, MetaAdapterFactory.getProperty(0x18bc659203a64e29L, 0xa83a7ff23bde13baL, 0xf9eb01232eL, 0xf9eb01232fL, "text"), (String) parameter_1);
    return quotedNode_2;
  }
  private static boolean eq_z4rl0_a0a0a0a0a0a2a5(Object a, Object b) {
    return (a != null ? a.equals(b) : a == b);
  }
  private static boolean neq_z4rl0_a0a0a0a0a0d0h(Object a, Object b) {
    return !(((a != null ? a.equals(b) : a == b)));
  }
  private static boolean eq_z4rl0_a0c0a0a0a0a0b0x(Object a, Object b) {
    return (a != null ? a.equals(b) : a == b);
  }
}
